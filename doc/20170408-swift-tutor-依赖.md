## 什么是依赖

简单的说，如果 A 认识 B，那么 A 对 B 有依赖。
比如 **老马识途**，老马认识回去的路，我们就可以说 `Horse` 依赖了 `Route`。但是要注意，路并不认识老马。

如果 B 同时也认识 A，那么 A 和 B 的依赖是相互的。
比如老马自家的马厩里有很多马，马和马厩是相互认识的，虽然马厩不是活物，但却是客观存在的，那么它就可以 **认识** 马。

为什么路不认识马，马厩却认识马？路也是客观存在，原来也叫马路，为什么不认识马？
这个问题问的很好，我们最后再说…

## 依赖的抽象度
依赖可以很抽象，如一个人可以有家庭地址，也可以很具体，如张三在某小区的地址。对应到程序中，从抽象到具体，
- 我们可以说 **类型**（class 或 type）之间有依赖，
- 也可以说 **对象**（object）或实例（instance）之间有依赖，
- 而且，**对象和类型** 之间也可以有依赖（如一个对象依赖了另一个类的静态方法）。

*同一个依赖，体现在代码里就是抽象的，体现在运行时就是具体的，抽象还是具体多数情况下不重要，所以可以简单的说，A 和 B 之间有依赖*

依赖一定是 **二元关系**，或多元关系。换一个词就好理解了：**耦合**（coupling）。A 和 B 耦合太高，就说明他们之间的依赖不清晰。如果你了解过数据库，依赖很像是 E-R 图中的关系表。

### 如何识别依赖、表示依赖（答：1. 先识别类型；2. 用实线箭头）
> 要注意的是 **继承关系**，“子类依赖父类”、“子类实现依赖父类实现”这些说法都没有问题，也存在二元关系。但是由于在运行时没有 **多元关系**，子类、父类可以单独出现、单独存在，所以在描述实体间的关系时（比如 UML 的类图中），通常会明确区分继承和依赖。

依赖体现在代码中的很多地方，比如成员变量、方法参数、返回值、回调函数、等等；识别起来也非常简单，在强类型的语言中，**需要写明类型的地方都是依赖**。（很简单，不展开了）

由于代码中的变量、方法都是属于一个特定的类型，可将描述简化为 **类型 A 依赖于类型 B**。比如人名是 String 类型的，我们可以说 `Person.name` 依赖于 `String`，也可以说 `Person` 依赖于 `String`，不过还是推荐用最简单的方式：
```
Person -> String
```
用符号（`->`）表示依赖更简单，而且双向依赖（`<->`）、弱依赖(实线换成虚线)也很容易表示。

#### 用箭头够吗？
先陈述事实，在 UML 的类图中：
1. 实线箭头叫做 **关联**
1. 虚线箭头叫做 **依赖**
1. 实线三角形箭头是 **继承父类**
1. 虚线三角形箭头是 **实现接口**

以前我以为 UML 是需要严格遵循的标准，殊不知它只是辅助建模的工具，它本身的繁琐只是提供了一种可能性，关键还是要自己用着舒服。

四色定理表明四种颜色即可给地图着色，基本算数也只有加减乘除，这些都体现了 **用较少的符号表示丰富内容** 的思想。我想说，针对 UML，只用箭头其实是够的，尤其是写文档、用笔在纸上画的时候。

而且我们基本上不需要同时在一张图中表示继承关系和依赖关系，索性只用箭头（`->`）得了，必要时结合虚线箭头（*注意，表示继承关系的箭头多数是朝上的，表示依赖关系则是左右的*）

### 需要关注的依赖（模块间的、业务相关的）
之前 `Person -> String` 的例子其实没什么意义，名字每个人都有且一定是 String，这个依赖太细枝末节了（too subtle）。而且对系统类型的依赖是不可避免的，所以可以忽略他们。同样，对第三方库的依赖虽然是必须的，但是太笼统，也可以忽略。

那么什么样的依赖比较重要呢，举个例子，你一定听过 `MVC`，在 MVC 中，模型（Model）、视图（View）、控制器（Controller）的 **粒度** （granularity）都很适中。这些也正好是我们需要写代码实现的东西。*可以从 MVC 开始，逐步了解 MVP、MVVM、VIPER、Clean Architecture。*

明确依赖其实就是在做架构（SA，software architecture），进而明确 **模块间的依赖**，并从无到有 **将模块识别出来** 并实现。

## 总结
依赖是软件模块间的耦合，可用 `->` 表示，开发过程中要做的就是识别依赖、简化依赖。

---
## 马路之于马
马厩认识马，那么马路认识马么？

前面说继承关系不被看做依赖，是因为子类父类可以单独出现；但是是否可以单独出现并不是黄金法则。
回到马的例子，马厩没马，它还是马厩，马路没马它还是路。马厩里有多少匹马，跟马路上有多少匹马，是类似的 —— 关键是你的模型是否需要路知道上面有多少匹马，**是否需要途识老马**。

而且
> 你要注意到本文中其实把 **关联** 和 **依赖** 统称为依赖。

马和马厩的关系是 **依赖**，因为他们可以单独存在。而马厩和里面的水槽、小隔间等则是 **关联** —— 房间里没有水槽、小隔间，是不能称作马厩的，马厩是个整体，**是个独立的概念**。
UML 的关联可以看做强依赖，反正 UML 并不是强制的，而且很多概念、框架都用的是依赖而不是关联（依赖注入，依赖倒转等）。

---
# 练习
拿出纸笔，打开搜索引擎，画一下 MVC 及其变体之间的依赖（用箭头表示）。
